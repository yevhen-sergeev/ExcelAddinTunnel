self.onmessage=async function(e){const{n:o}=e.data;if(console.log("Web Worker: входное значение",o),o<0||!Number.isInteger(o))return void postMessage({error:"Число должно быть неотрицательным целым."});if(o>500)return void postMessage({error:"Число должно быть меньше 500."});const t=await OfficeRuntime.storage.getItem("orientationMode")||"row";console.log("Режим из storage в Worker:",t);const r=`${o}_${t}`;if(factorialCache.has(r))return postMessage({result:factorialCache.get(r)}),void console.log("Web Worker: результат из кэша",r);{const e=[];let s=BigInt(1);for(let t=1;t<=o;t++)s*=BigInt(t),e.push(s.toString());const a="row"===t?[e]:e.map((e=>[e]));factorialCache.set(r,a),console.log("Web Worker: вычисленный результат",r)}postMessage({result:result})};