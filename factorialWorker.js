const factorialCache=new Map;self.onmessage=async function(e){const{n:o}=e.data;if(console.log("Web Worker: входное значение",o),o<0||!Number.isInteger(o))return void postMessage({error:"Число должно быть неотрицательным целым."});if(o>500)return void postMessage({error:"Число должно быть меньше 500."});const t=await OfficeRuntime.storage.getItem("orientationMode")||"row";console.log("Режим из storage в Worker:",t);const s=`${o}_${t}`;if(factorialCache.has(s)){const e=factorialCache.get(s);console.log("Web Worker: результат из кэша",s),postMessage({cachedResult:e})}else{const e=[];let r=BigInt(1);for(let t=1;t<=o;t++)r*=BigInt(t),e.push(r.toString());const a="row"===t?[e]:e.map((e=>[e]));factorialCache.set(s,a),console.log("Web Worker: вычисленный результат",s),postMessage({result:a})}};