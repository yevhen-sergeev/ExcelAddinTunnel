{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://CustomFunctions/webpack/bootstrap","webpack://CustomFunctions/webpack/runtime/define property getters","webpack://CustomFunctions/webpack/runtime/hasOwnProperty shorthand","webpack://CustomFunctions/webpack/runtime/make namespace object","webpack://CustomFunctions/./src/functions/functions.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* global clearInterval, console, CustomFunctions, setInterval */\r\n\r\n/**\r\n * Writes a message to console.log().\r\n * @customfunction LOG\r\n * @param message String to write.\r\n * @returns String to write.\r\n */\r\nexport function logMessage(message: string): string {\r\n  console.log(message);\r\n\r\n  return message;\r\n}\r\n\r\n/*\r\n * Возвращает ряд факториалов от 0 до n.\r\n * @customfunction FACTORIALROW\r\n * @param {number} n Число, до которого считать факториалы\r\n * @returns {number[][]} Ряд факториалов от 0 до n (в виде вертикального массива)\r\n *\r\nexport function factorialRow(n: number): number[][] {\r\n  console.log(\"Входное значение:\", n);\r\n\r\n  if (n < 0 || !Number.isInteger(n)) {\r\n    console.error(\"Ошибка: введено отрицательное или нецелое число\");\r\n    throw new Error(\"Input must be a non-negative integer.\");\r\n  }\r\n\r\n  const result: number[][] = [];\r\n  let factorial = 1;\r\n\r\n  for (let i = 0; i <= n; i++) {\r\n    factorial *= i || 1;\r\n    result.push([factorial]);\r\n    console.log(`Факториал ${i} = ${factorial}`);\r\n  }\r\n\r\n  console.log(\"Результат:\", result);\r\n  return result;\r\n}\r\n*/\r\n\r\nconst factorialCache: Map<string, string[][]> = new Map();\r\n\r\n/**\r\n * Возвращает ряд факториалов от 0 до n.\r\n * @customfunction FACTORIALROW\r\n * @param {number} n Число, до которого считать факториалы\r\n * @returns {Promise<string[][]>} Ряд факториалов от 0 до n (в виде вертикального массива)\r\n */\r\nexport async function factorialRow(n: number): Promise<string[][]> {\r\n    console.log(\"Входное значение:\", n);\r\n\r\n    if (n < 0 || !Number.isInteger(n)) {\r\n      console.error(\"Ошибка: введено отрицательное или нецелое число\");\r\n      throw new Error(\"Input must be a non-negative integer.\");\r\n    }\r\n    else if (n > 500) {\r\n      console.error(\"Ошибка: введено число больше 500\");\r\n      throw new Error(\"Input must be less then 500.\");\r\n    }\r\n\r\n    // const mode: string | null = await OfficeRuntime.storage.getItem('resultMode');\r\n    // const mode: string | null = await OfficeRuntime.storage.getItem(\"orientationMode\");\r\n    const mode: string = 'column';\r\n    console.log(\"Режим из storage:\", mode);\r\n    // Создание ключа из n и mode\r\n    const cacheKey = `${n}_${mode}`;\r\n\r\n    let result: string[][];\r\n\r\n    // Если значение уже вычислено, возвращаем его из кеша\r\n    if (factorialCache.has(cacheKey)) {\r\n      result = factorialCache.get(cacheKey)!;\r\n      console.log(\"Результат из factorialCache:\", result);\r\n    }\r\n    else {\r\n      const resultArray: string[] = [];\r\n      let factorial: bigint = BigInt(1);\r\n\r\n      for (let i = 1; i <= n; i++) {\r\n        factorial *= BigInt(i);\r\n        resultArray.push(factorial.toString());\r\n        //console.log(`Факториал ${i} = ${factorial}`);\r\n      }\r\n\r\n      if (mode === 'row') {\r\n        result = [resultArray]; // строка: одна строка, много колонок\r\n      }\r\n      else {\r\n        // колонка: много строк, одна колонка\r\n        result = resultArray.map(val => [val]);\r\n      }\r\n\r\n      factorialCache.set(cacheKey, result);\r\n\r\n      console.log(\"Результат:\", result);\r\n    }\r\n\r\n    return result;\r\n}\nCustomFunctions.associate(\"LOG\", logMessage);\nCustomFunctions.associate(\"FACTORIALROW\", factorialRow);"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","e","t","r","n","iterator","i","c","Generator","u","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","done","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","logMessage","message","console","log","factorialCache","Map","factorialRow","_x","_factorialRow","apply","arguments","_callee","mode","cacheKey","result","resultArray","factorial","_context","Number","isInteger","error","Error","concat","has","BigInt","push","toString","map","val","set","_next","_throw","CustomFunctions","associate"],"sourceRoot":""}